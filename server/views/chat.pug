extends layout

block content
  // MAIN GRID (keep grid separate from modal)
  .grid-root
    // LEFT SIDEBAR
    aside.left-column
      h2 Topics

        //- If there are chats, render them as cards inside placeholders
      ul#chat-list
        if chats && chats.length       
          each chat in chats
            li.chat-card
              a.chat-link(href=`/messages/${chat.id}/messages`,
               data-chat-id=chat.id) #{chat.name}                
        else        
          li.placeholder
          li.placeholder
          li.placeholder
          li.placeholder

    // CENTER COLUMN
    main.center-column
      .chat-creation-box#chat-creation-area
        h3 Opret ny chat
        form#chat-form
          input(type="text", id="chat-name", placeholder="Chat navn", required)
          button.btn-primary(type="submit") Opret

      h2.center-title CHAT NAME
      // Valgt chats navn
      h3#current-chat-title Ingen valgt chat
      
      
      // Liste over beskeder
      ul#message-list

      // ---BUTTONS (Opret / Slet) ---
      if user && (user.accessLevel === 2 || user.accessLevel === 3)
        .chat-footer
          button#createChatBtn(type="button") Opret
          button#deleteChatBtn(type="button") Slet    
        

    // RIGHT SIDEBAR
    aside.right-column
      h3 BRUGER
       p#room-details SÃ¸ge funktion
       
  // LOGIN MODAL 
  div#loginModal.login-modal
    .modal-content
      h2 Log ind
      form#loginForm(method="POST", action="/users/login")
        label(for="username") Brugernavn
        input#username(type="text", name="username", required)

        label(for="password") Password
        input#password(type="password", name="password", required)

        button(type="submit") Log ind

  // small inline script to toggle modal visibility based on server-provided window.USER
  script.
    document.addEventListener('DOMContentLoaded', () => {
      const user = window.USER;
      const modal = document.getElementById('loginModal');
      const messageForm = document.getElementById('message-form');

      if (user) {
        if (modal) modal.style.display = 'none';
        if (messageForm) messageForm.style.display = 'flex';
      } else {
        if (modal) modal.style.display = 'flex';
        if (messageForm) messageForm.style.display = 'none';
      }
    });
